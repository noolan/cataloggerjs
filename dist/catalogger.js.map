{"version":3,"sources":["../node_modules/js-levenshtein/index.js","utilities.js","regular-expressions.js","constants.js","catalogger.js"],"names":["module","exports","_min","d0","d1","d2","bx","ay","a","b","length","tmp","la","lb","charCodeAt","offset","x","y","d3","dd","dy","bx0","bx1","bx2","bx3","vector","push","len","clone","variable","JSON","parse","stringify","cloneEnumerable","v","e","console","error","getNestedValue","obj","keys","defaultValue","undefined","idProperty","intsAreIds","keySeparator","logErrors","split","Array","isArray","namedLogError","key","splice","int","parseInt","Number","isNaN","found","findByProperty","castToInt","logError","args","arg","name","group","groupEnd","valueToArray","value","blank","removeEmpty","separator","trimStrings","arr","Symbol","iterator","Object","values","String","i","trim","type","valueToString","glue","join","REGULAR_EXPRESSIONS","articlesAndDeterminers","multiSpace","multiWhitespace","punctuation","singleCharacters","singleCharactersWordBoundries","tabsAndVerticalWhitespace","whitespace","DEFAULT_CONFIG","relevance","inject","field","threshold","results","limit","sort","byRelevance","enabled","fields","string","replacements","exp","val","grouped","LENGTH","OCCURENCES","RELEVANCE","WEIGHT","BUILD_INDEX","GET_RESULTS","INVALIDATE_RESULTS","INVALIDATE_SORTING","NORMALIZE_STRING","UPDATE_RESULTS","CACHE","CONFIG","DATA","INDEX","RESULTS","QUERY","levenshtein","require","Catalogger","documents","options","stringNormalizations","Map","dictionary","create","valid","items","sorted","processed","raw","tokens","config","query","result","dict","includes","rawText","toLowerCase","normalizedText","tokenIndex","token","fieldLength","foundAt","Math","log","docWeight","docs","resultDocuments","set","entries","item","from","output","doc","clear","input","normalizedString","str","has","get","replacement","match","exec","substring","index","start","middle","end","replace","map","k","dictTokens","queryToken","dictToken","matchValue","min","distance","collator","Intl","Collator","caseFirst","ignorePunctuation","localeMatcher","numeric","sensitivity","usage","docA","docB","comparison","compare","direction","toUpperCase","reIndex","rawFields","documentFields","same","rawQuery","Set","catalog","using"],"mappings":"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","file":"catalogger.js","sourceRoot":"../src","sourcesContent":["'use strict';\nmodule.exports = (function()\n{\n  function _min(d0, d1, d2, bx, ay)\n  {\n    return d0 < d1 || d2 < d1\n        ? d0 > d2\n            ? d2 + 1\n            : d0 + 1\n        : bx === ay\n            ? d1\n            : d1 + 1;\n  }\n\n  return function(a, b)\n  {\n    if (a === b) {\n      return 0;\n    }\n\n    if (a.length > b.length) {\n      var tmp = a;\n      a = b;\n      b = tmp;\n    }\n\n    var la = a.length;\n    var lb = b.length;\n\n    while (la > 0 && (a.charCodeAt(la - 1) === b.charCodeAt(lb - 1))) {\n      la--;\n      lb--;\n    }\n\n    var offset = 0;\n\n    while (offset < la && (a.charCodeAt(offset) === b.charCodeAt(offset))) {\n      offset++;\n    }\n\n    la -= offset;\n    lb -= offset;\n\n    if (la === 0 || lb < 3) {\n      return lb;\n    }\n\n    var x = 0;\n    var y;\n    var d0;\n    var d1;\n    var d2;\n    var d3;\n    var dd;\n    var dy;\n    var ay;\n    var bx0;\n    var bx1;\n    var bx2;\n    var bx3;\n\n    var vector = [];\n\n    for (y = 0; y < la; y++) {\n      vector.push(y + 1);\n      vector.push(a.charCodeAt(offset + y));\n    }\n\n    var len = vector.length - 1;\n\n    for (; x < lb - 3;) {\n      bx0 = b.charCodeAt(offset + (d0 = x));\n      bx1 = b.charCodeAt(offset + (d1 = x + 1));\n      bx2 = b.charCodeAt(offset + (d2 = x + 2));\n      bx3 = b.charCodeAt(offset + (d3 = x + 3));\n      dd = (x += 4);\n      for (y = 0; y < len; y += 2) {\n        dy = vector[y];\n        ay = vector[y + 1];\n        d0 = _min(dy, d0, d1, bx0, ay);\n        d1 = _min(d0, d1, d2, bx1, ay);\n        d2 = _min(d1, d2, d3, bx2, ay);\n        dd = _min(d2, d3, dd, bx3, ay);\n        vector[y] = dd;\n        d3 = d2;\n        d2 = d1;\n        d1 = d0;\n        d0 = dy;\n      }\n    }\n\n    for (; x < lb;) {\n      bx0 = b.charCodeAt(offset + (d0 = x));\n      dd = ++x;\n      for (y = 0; y < len; y += 2) {\n        dy = vector[y];\n        vector[y] = dd = _min(dy, d0, dd, bx0, vector[y + 1]);\n        d0 = dy;\n      }\n    }\n\n    return dd;\n  };\n})();\n\n","const clone = function (variable) {\n  if (typeof variable === 'object') {\n    return JSON.parse(JSON.stringify(variable))\n  } else {\n    return variable\n  }\n}\n\nconst cloneEnumerable = function (v) {\n  try {\n    return typeof v === 'object' ? JSON.parse(JSON.stringify(v)) : v\n  } catch (e) {\n    console.error(e, v)\n    return v\n  }\n}\n\nconst getNestedValue = function (\n  obj,\n  keys = [],\n  {\n    defaultValue = undefined, idProperty = 'id', intsAreIds = true, keySeparator = '/', logErrors = false\n  } = {\n    defaultValue: undefined, idProperty: 'id', intsAreIds: true, keySeparator: '/', logErrors: false\n  }\n) {\n  if (typeof keys === 'string') {\n    keys = keys.split(keySeparator)\n  }\n  if (!Array.isArray(keys)) {\n    if (logErrors) { namedLogError('Invalid keys parameter', {keys}) }\n    return defaultValue\n  }\n\n  if (keys.length) {\n    if (typeof obj !== 'object' || obj === null) {\n      if (logErrors) { namedLogError('Nested object not found at given key', {obj, keys}) }\n      return defaultValue\n    }\n    const key = keys.splice(0, 1)[0]\n    if (key === '') {\n      return getNestedValue(obj, keys, { defaultValue, idProperty, intsAreIds })\n    }\n    const int = parseInt(key, 10)\n    if (!Number.isNaN(int)) {\n      if (intsAreIds) {\n        const found = findByProperty(obj, idProperty, int, { castToInt: true })\n        if (typeof found !== 'undefined') {\n          return getNestedValue(found, keys, { defaultValue, idProperty, intsAreIds })\n        }\n      } else if (typeof obj[int] !== 'undefined') {\n        return getNestedValue(obj[int], keys, { defaultValue, idProperty, intsAreIds })\n      }\n    }\n    if (typeof obj[key] !== 'undefined') {\n      return getNestedValue(obj[key], keys, { defaultValue, idProperty, intsAreIds })\n    }\n    if (logErrors) { namedLogError('Nested object not found at given key', {obj, key}) }\n    return defaultValue\n  } else {\n    return obj\n  }\n}\n\nconst logError = function (...args) {\n  for (const arg of args) {\n    if (typeof arg === 'object') {\n      console.error(clone(arg))\n    } else {\n      console.error(arg)\n    }\n  }\n  return args\n}\n\nconst namedLogError = function (name, ...args) {\n  console.group(name)\n  logError(args)\n  console.groupEnd()\n}\n\nconst valueToArray = function (\n  value,\n  { \n    blank = [], removeEmpty = false, separator = undefined, trimStrings = false\n  } = {\n    blank: [], removeEmpty: false, separator: undefined, trimStrings: false\n  }\n) {\n  let arr = null\n  switch (typeof value) {\n    case 'object':\n      if (value === null) { return blank }\n      arr = [...(typeof value[Symbol.iterator] === 'function' ? value : Object.values(value))]\n      break\n    case 'undefined': return blank\n    case 'string':\n    default: value = String(value)\n      arr = value.split(separator)\n  }\n\n  if (trimStrings) {\n    for (let i=0; i<arr.length; i++) {\n      if (typeof arr[i] === 'string') {\n        arr[i] = arr[i].trim()\n      }\n    }\n  }\n\n  if (removeEmpty) {\n    for (let i=0; i<arr.length; i++) {\n      const type = typeof arr[i]\n      if (\n        (type === 'string' && arr[i].trim() === '') ||\n        arr[i] === null || type === 'undefined'\n      ) {\n        arr.splice(i--, 1)\n      }\n    }\n  }\n  return arr\n}\n\nconst valueToString = function (value, { blank = '', glue = ', ' } = { blank: '', glue: ', ' }) {\n  switch (typeof value) {\n    case 'string': return value\n    case 'object':\n      if (value === null) { return blank }\n      return [...(typeof value[Symbol.iterator] === 'function' ? value : Object.values(value))].join(glue)\n    case 'undefined': return blank\n    default: return String(value)\n  }\n}\n\nexport { clone, cloneEnumerable, getNestedValue, logError, namedLogError, valueToArray, valueToString }\n","// negative and positive lookbehinds are not supported in Edge, Firefox, or Safari as of Oct 2019\n// https://caniuse.com/#feat=js-regexp-lookbehind\n\nconst REGULAR_EXPRESSIONS = {\n  // matches common articles and determiners\n  articlesAndDeterminers: /\\b(?:a|an|and|are|is|of|the|to)\\b/g,\n\n  // matches multiple spaces\n  multiSpace: /\\ \\ +/g,\n\n  // matches multiple whitespace characters\n  multiWhitespace: /\\s\\s+/g,\n\n  // matches common punctuation except for decimal/thousands separators and number signs (+/-)\n  punctuation: /(?:(\\.|\\,)(?!\\d)|(?:[^\\d](\\+|\\-)[^\\d])|([\\(\\)\\[\\]\\{\\}\\?\\:\\;\\\"\\'\\_\\=]))/g, // has capture group\n  // punctuationLookbehind: /[\\.\\,](?!\\d)|(?<!\\d)[\\+\\-](?!\\d)|[\\(\\)\\[\\]\\{\\}\\?\\:\\;\\\"\\'\\_\\=]/g,\n\n  // matches single letters/digits surrounded by whitespace or at the beginning/end of strings/lines\n  singleCharacters: /(?:^|\\s)([a-z0-9])(?=$|\\s)/gm, // has capture group\n  // singleCharactersLookbehind: /(?:(?<=^|\\s).(?=$|\\s))/gm,\n  \n  // matches single characters at word boundries\n  singleCharactersWordBoundries: /\\b[a-z0-9]\\b/g,\n  \n  //  matches all whitespace characters except spaces (newlines, tabs, vertical tabs)\n  tabsAndVerticalWhitespace: /[\\t\\v]/g,\n  \n  // matches all whitespace characters \n  // newlines, spaces, tabs, vertical tabs\n  whitespace: /\\s/g,\n}\n\nexport default REGULAR_EXPRESSIONS","import REGULAR_EXPRESSIONS from './regular-expressions'\nexport { REGULAR_EXPRESSIONS }\n\nexport const DEFAULT_CONFIG = {\n  relevance: { inject: false, field: '_relevance', threshold: -1 },\n  results: { limit: -1 },\n  sort: { byRelevance: true, enabled: true, fields: null },\n  string: {\n    replacements: [\n      { exp: REGULAR_EXPRESSIONS.singleCharacters, val: '' },\n      { exp: REGULAR_EXPRESSIONS.punctuation, val: ' ', grouped: true },\n      { exp: REGULAR_EXPRESSIONS.articlesAndDeterminers, val: ' ' },\n      { exp: REGULAR_EXPRESSIONS.tabsAndVerticalWhitespace, val: ' ' },\n      { exp: REGULAR_EXPRESSIONS.multiSpace, val: ' ' }\n    ]\n  }\n}\n\n// dictionary property symbols\nexport const LENGTH = Symbol('length')\nexport const OCCURENCES = Symbol('occurences')\nexport const RELEVANCE = Symbol('relevance')\nexport const WEIGHT = Symbol('weight')\n\n// private method symbols\nexport const BUILD_INDEX = Symbol('buildIndex')\nexport const GET_RESULTS = Symbol('getResults')\nexport const INVALIDATE_RESULTS = Symbol('invalidateResults')\nexport const INVALIDATE_SORTING = Symbol('invalidateSorting')\nexport const NORMALIZE_STRING = Symbol('normalizeString')\nexport const UPDATE_RESULTS = Symbol('updateResults')\n\n// private property symbols\nexport const CACHE = Symbol('cache')\nexport const CONFIG = Symbol('config')\nexport const DATA = Symbol('data')\nexport const INDEX = Symbol('index')\nexport const RESULTS = Symbol('results')\nexport const QUERY = Symbol('query')\n","const levenshtein = require('js-levenshtein')\nimport { cloneEnumerable, getNestedValue, namedLogError, valueToArray, valueToString } from './utilities'\nimport {\n  REGULAR_EXPRESSIONS, DEFAULT_CONFIG,\n  LENGTH, OCCURENCES, RELEVANCE, WEIGHT,\n  BUILD_INDEX, GET_RESULTS, INVALIDATE_RESULTS, INVALIDATE_SORTING, NORMALIZE_STRING, UPDATE_RESULTS,\n  CACHE, CONFIG, DATA, INDEX, RESULTS, QUERY\n} from './constants'\n\nclass Catalogger {\n\n  constructor (documents, fields, options) {\n    this[CACHE] = { stringNormalizations: new Map() }\n    this[CONFIG] = { relevance: {}, results: {}, sort: {} }\n    this[DATA] = { documents: [], fields: [], type: 'Array' }\n    this[INDEX] = { dictionary: Object.create(null), valid: true }\n    this[RESULTS] = { items: new Map(), sorted: true, valid: true }\n    this[QUERY] = { processed: '', raw: '', tokens: [] }\n\n    this.config = options\n    this.documents = documents\n    this.fields = fields\n  }\n\n  get config () { return cloneEnumerable(this[CONFIG]) }\n  set config ({ relevance={}, results={}, sort={}, string={} } = { relevance:{}, results:{}, sort:{}, string:{} }) {\n    const config = {\n      relevance: { ...DEFAULT_CONFIG.relevance, ...this[CONFIG].relevance, ...relevance },\n      results: { ...DEFAULT_CONFIG.results, ...this[CONFIG].results, ...results },\n      sort: { ...DEFAULT_CONFIG.sort, ...this[CONFIG].sort, ...sort },\n      string: { ...DEFAULT_CONFIG.string, ...this[CONFIG].string, ...string },\n    }\n    config.sort.fields = valueToArray(config.sort.fields, { removeEmpty: true, trimStrings: true })\n    this[CONFIG] = config\n    this.reIndex()\n  }\n\n  get documents () { return this[DATA].documents }\n  set documents (documents) {\n    if (documents !== this[DATA].documents) {\n      if (typeof documents === 'undefined' || documents === 'null') {\n        this[DATA].documents = []\n      } else {\n        this[DATA].documents = documents\n      }\n      if (Array.isArray(this[DATA].documents)) {\n        this[DATA].type = 'Array'\n      } else {\n        this[DATA].type = 'Object'\n      }\n      this.reIndex()\n    }\n  }\n\n  get fields () { return cloneEnumerable(this[DATA].fields) }\n  set fields (rawFields) {\n    const fields = valueToArray(rawFields, { removeEmpty: true, trimStrings: true })\n    // no fields supplied so we use the fields from the first document\n    if (fields.length === 0 && typeof this[DATA].documents === 'object') {\n      const documents = Object.keys(this[DATA].documents)\n      if (typeof this[DATA].documents[documents[0]] === 'object') {\n        const documentFields = Object.keys(this[DATA].documents[documents[0]])\n        for (const field of documentFields) {\n          if (typeof this[DATA].documents[documents[0]][field] !== 'object') {\n            fields.push(field)\n          }\n        }\n      }\n    }\n    // check if fields have changed\n    if (fields.length === this[DATA].fields.length) {\n      let same = true\n      for (let i = 0; i < fields.length; i++) {\n        if (fields[i] !== this[DATA].fields[i]) {\n          same = false\n          break;\n        }\n      }\n      if (same) {\n        return undefined\n      }\n    }\n    this[DATA].fields = fields\n    this.reIndex()\n  }\n\n  get query () { return this[QUERY].raw }\n  set query (rawQuery) {\n    if (typeof rawQuery === 'string') {\n      if (rawQuery !== this[QUERY].raw) {\n        this[QUERY].raw = rawQuery\n        const processed = this[NORMALIZE_STRING](rawQuery)\n        if (processed !== this[QUERY].processed) {\n          this[QUERY].processed = processed\n          this[QUERY].tokens = [...new Set(processed.split(' '))] // remove duplicates\n          this[INVALIDATE_RESULTS]()\n        }\n      }\n    } else { // invalid rawQuery provided\n      this[QUERY].processed = ''\n      this[QUERY].raw = ''\n      this[QUERY].tokens = []\n    }\n  }\n\n  get indexed () { return this[INDEX].valid }\n  get evaluated () { return this[RESULTS].valid }\n  get sorted () { return this[RESULTS].sorted }\n\n  reIndex () {\n    this[INDEX].valid = false\n    this[INVALIDATE_RESULTS]()\n    this[BUILD_INDEX]()\n    return this\n  }\n\n  resultsFor (query) {\n    this.query = query\n    return this[GET_RESULTS]()\n  }\n\n  *[Symbol.iterator] () {\n    yield* this.result()\n  }\n\n  *result () {\n    const results = this[GET_RESULTS]()\n    for (const result of results) {\n      yield result\n    }\n  }\n\n  [BUILD_INDEX] () {\n    if (!this[INDEX].valid) {\n      if (this[DATA].documents !== null && typeof this[DATA].documents === 'object' && Array.isArray(this[DATA].fields)) {\n        const keys = Object.keys(this[DATA].documents)\n        this[INDEX].dictionary = Object.create(null)\n        const dict = this[INDEX].dictionary\n\n        for (const key of keys) {\n\n          for (const field of this[DATA].fields) {\n            let value = ''\n\n            if (field.includes('.')) {\n              value = getNestedValue(this[DATA].documents[key], field, { keySeparator: '.' })\n            } else {\n              value = this[DATA].documents[key][field]\n            }\n            const rawText = valueToString(value, { glue: ' '}).toLowerCase().trim()\n            if (rawText !== '') {\n              const normalizedText = this[NORMALIZE_STRING](rawText)\n              const tokens = normalizedText.split(' ')\n              let tokenIndex = 0\n\n              for (const token of tokens) {\n                if (typeof dict[token] === 'undefined') {\n                  \n                  dict[token] = Object.create(null)\n                  dict[token][LENGTH] = token.length\n                  dict[token][OCCURENCES] = 0\n                }\n\n                if (typeof dict[token][key] === 'undefined') {\n                  dict[token][key] = Object.create(null)\n                  dict[token][key][OCCURENCES] = 0\n                }\n\n                if (typeof dict[token][key][field] === 'undefined') {\n                  dict[token][key][field] = Object.create(null)\n                  dict[token][key][field].fieldLength = rawText.length\n                  dict[token][key][field].foundAt = []\n                  dict[token][key][field][OCCURENCES] = 0\n                }\n\n                dict[token][OCCURENCES]++\n                dict[token][key][OCCURENCES]++\n                dict[token][key][field][OCCURENCES]++\n\n                dict[token][key][field].foundAt.push(tokenIndex)\n\n                tokenIndex++\n              } // end loop over field tokens\n            } // end if field is empty\n          } // end loop over searchable fields\n        \n        } // end loop over document keys\n        \n        // calculate dictionary entry weights\n        for (const token of Object.keys(dict)) {\n          dict[token][WEIGHT] = 1 / (Math.log(dict[token][OCCURENCES]) + 1)\n          for (const key of Object.keys(dict[token])) {\n            let docWeight = 0\n            for (const field of Object.keys(dict[token][key])) {\n              docWeight += 1 / (Math.log(dict[token][key][field].fieldLength) + 1)\n            }\n            dict[token][key][WEIGHT] = docWeight / dict[token][key][OCCURENCES]\n          }\n        }\n\n      } // end if documents usable\n\n      this[INDEX].valid = true\n    }\n    return this\n  }\n\n  [GET_RESULTS] () {\n    this[UPDATE_RESULTS]()\n\n    const docs = this[DATA].documents\n    const items = this[RESULTS].items\n    const threshold = this[QUERY].processed === '' ? -1 : this[CONFIG].relevance.threshold\n\n    let limit = this[CONFIG].results.limit\n    const resultDocuments = new Map()\n\n    // choosing to duplicate code so there are fewer comparisons inside the loop\n    if (limit === -1) { // unlimited\n      if (threshold === -1) { // all results\n        for (const key of items.keys()) {\n          resultDocuments.set(key, docs[key])\n        }\n      } else { // results that exceed threshold\n        if (this[CONFIG].sort.enabled) { // items are sorted so we can stop when the threshold is reached\n          for (const item of items.entries()) {\n            if (item[1] >= threshold) {\n              resultDocuments.set(item[0], docs[item[0]])\n            } else {\n              break\n            }\n          }\n        } else { // items are unsorted so we have to loop through all of them\n          for (const item of items.entries()) {\n            if (item[1] >= threshold) {\n              resultDocuments.set(item[0], docs[item[0]])\n            }\n          }\n        }\n      }\n    } else { // limited\n      if (threshold === -1) { // all results\n        for (const key of items.keys()) {\n          if (limit > 0) {\n            resultDocuments.set(key ,docs[key])\n            limit--\n          } else {\n            break\n          }\n        }\n      } else { // results that exceed threshold\n        if (this[CONFIG].sort.enabled) { // items are sorted so we can stop when the limit or threshold is reached\n          for (const item of items.entries()) {\n            if (item[1] >= threshold && limit > 0) {\n              resultDocuments.set(item[0], docs[item[0]])\n              limit--\n            } else {\n              break\n            }\n          }\n        } else { // items are unsorted so we have to loop through them until the limit is reached\n          for (const item of items.entries()) {\n            if (item[1] >= threshold && limit > 0) {\n              resultDocuments.set(item[0], docs[item[0]])\n              limit--\n            } else if (limit < 1) {\n              break\n            }\n          }\n        }\n      }\n    }\n\n    if (this[DATA].type === 'Array') {\n      return Array.from(resultDocuments.values())\n    } else {\n      const output = Object.create(null)\n      for (const doc of resultDocuments.entries()) {\n        output[doc[0]] = doc[1]\n      }\n      return output\n    }\n  }\n\n  [INVALIDATE_RESULTS] () {\n    this[RESULTS].items.clear()\n    this[INVALIDATE_SORTING]()\n    this[RESULTS].valid = false\n    return this\n  }\n\n  [INVALIDATE_SORTING] () {\n    this[RESULTS].sorted = false\n    return this\n  }\n\n  [NORMALIZE_STRING] (input) {\n    let normalizedString = ''\n    const str = input.toLowerCase().trim()\n\n    if (this[CACHE].stringNormalizations.has(str)) {\n      normalizedString = this[CACHE].stringNormalizations.get(str)\n    } else {\n      normalizedString = str\n      \n      for (const replacement of this[CONFIG].string.replacements) {\n        if (replacement.grouped) {\n          let match = []\n          while ((match = replacement.exp.exec(normalizedString)) !== null) {\n            if (match.length === 1 || typeof match[1] === 'undefined') {\n              normalizedString = normalizedString.substring(0, match.index) + replacement.val + normalizedString.substring(match.index + match[0].length)\n            } else {\n              let start = normalizedString.substring(0, match.index)\n              let middle = normalizedString.substring(match.index, match.index + match[0].length)\n              let end = normalizedString.substring(match.index + match[0].length)\n\n              for (let i = 1; i < match.length; i++) {\n                if (typeof match[i] !== 'undefined') {\n                  middle = middle.replace(match[i], replacement.val)\n                }\n              }\n              normalizedString = start + middle + end\n            }\n          }\n        } else {\n          normalizedString = normalizedString.replace(replacement.exp, replacement.val)\n        }\n      }\n      // remove any leading or trailing spaces left from the replacements\n      normalizedString = normalizedString.trim()\n\n      // store the result in the cache\n      this[CACHE].stringNormalizations.set(str, normalizedString)\n    }\n    return normalizedString\n  }\n\n  [UPDATE_RESULTS] () {\n    if (!this[INDEX].valid) {\n      this[BUILD_INDEX]()\n    }\n    if (!this[RESULTS].valid) {\n      this[INVALIDATE_SORTING]()\n      this[RESULTS].items = new Map(Object.keys(this[DATA].documents).map(k => [k, 0]))\n      const results = this[RESULTS].items\n      const dict = this[INDEX].dictionary\n      const dictTokens = Object.keys(dict)\n\n      for (const queryToken of this[QUERY].tokens) {\n        if (typeof dict[queryToken] !== 'undefined') {\n          for (const key of Object.keys(dict[queryToken])) {\n            let relevance = results.get(key)\n            relevance += dict[queryToken][WEIGHT] * dict[queryToken][key][WEIGHT]\n            results.set(key, relevance)\n          }\n        }\n        \n        for (const dictToken of dictTokens) {\n          let matchValue = 0\n          if ((queryToken.length > dictToken.length) ? queryToken.includes(dictToken) : dictToken.includes(queryToken)) {\n            matchValue = Math.min(queryToken.length, dictToken.length) * 0.1\n          } else {\n            const distance = levenshtein(queryToken, dictToken)\n            if (distance < 6) {\n              matchValue = (5 - distance) * 0.01\n            }\n          }\n\n          if (matchValue > 0) {\n            for (const key of Object.keys(dict[dictToken])) {\n              let relevance = results.get(key)\n              relevance += dict[dictToken][WEIGHT] * dict[dictToken][key][WEIGHT] * matchValue\n              results.set(key, relevance)\n            }\n          }\n        }\n      }\n\n      if (this[CONFIG].relevance.inject) {\n        if (this[QUERY].processed === '') {\n          for (const result of results.entries()) {\n            this[DATA].documents[result[0]][this[CONFIG].relevance.field] = 0\n          }\n        } else {\n          for (const result of results.entries()) {\n            this[DATA].documents[result[0]][this[CONFIG].relevance.field] = result[1]\n          }\n        }\n      }\n      this[RESULTS].valid = true\n    }\n\n    if (!this[RESULTS].sorted) {\n      if (this[CONFIG].sort.enabled) {\n        let results = Array.from(this[RESULTS].items.entries())\n        if (Array.isArray(this[CONFIG].sort.fields) && this[CONFIG].sort.fields.length) {\n          const collator = new Intl.Collator(\n            undefined,\n            {\n              caseFirst: 'false',\n              ignorePunctuation: false,\n              localeMatcher: 'best fit',\n              numeric: true,\n              sensitivity: 'base',\n              usage: 'sort'\n            }\n          )\n\n          results.sort((a, b) => {\n            const docA = this[DATA].documents[a[0]]\n            const docB = this[DATA].documents[b[0]]\n            let comparison = 0\n            for (const field of this[CONFIG].sort.fields) {\n              if (typeof field === 'string') {\n                comparison = collator.compare(docA[field], docB[field])\n              } else {\n                if (field.direction.substring(0, 4).toUpperCase() === 'DESC') {\n                  comparison = collator.compare(docB[field.key], docA[field.key])\n                } else {\n                  comparison = collator.compare(docA[field.key], docB[field.key])\n                }\n              }\n              if (comparison) {\n                return comparison\n              }\n            }\n            return comparison\n          })\n        }\n        if (this[CONFIG].sort.byRelevance) {\n          results.sort((a, b) => b[1] - a[1])\n        }\n        this[RESULTS].items = new Map(results)\n      }\n      this[RESULTS].sorted = true\n    }\n    return this\n  }\n}\n\n/**\n * Factory function to instantiate and configure a Catalog object\n * \n * @param  { [Object] }         documents\n * @param  { Object }           options.relevance\n * @param  { Boolean }          options.relevance.inject    [ false ]\n * @param  { String }           options.relevance.field     [ '_relevance' ]\n * @param  { Number }           options.relevance.threshold [ -1 ]\n * @param  { Number }           options.results.limit       [ -1 ]\n * @param  { Boolean }          options.sort.byRelevance    [ true ]\n * @param  { Boolean }          options.sort.enabled        [ true ]\n * @param  { [String/Object] }  options.sort.fields         [ null ]\n * @param  { [Object] }         options.string.replacements [ [{}] ]\n * @param  { String/[String] }  using                       [ [] ]\n * \n * @return { Catalog }\n */\nconst catalog = function (\n  documents,\n  {\n    relevance = {}, results = {}, sort = {}, string = {}, using = []\n  } = {\n    relevance: {}, results: {}, sort: {}, string: {}, using: []\n  }\n) {\n  return new Catalogger(documents, using, { relevance, results, sort, string })\n}\n\nconst replacements = DEFAULT_CONFIG.string.replacements\n\nexport {\n  catalog as default,\n  DEFAULT_CONFIG as config,\n  REGULAR_EXPRESSIONS as expressions,\n  replacements,\n}\n"]}